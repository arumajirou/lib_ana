<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Mermaid diagram for timesfm</title>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
           margin: 0; padding: 16px; background:#0b1020; color:#f9fafb; }
    .mermaid { background:#111827; border-radius: 12px; padding:16px; }
    h2 { margin-top: 0; }
  </style>
</head>
<body>
  <h2>Mermaid diagram for timesfm</h2>
  <div class="mermaid">
flowchart TD
  %% Library: timesfm
  timesfm[&quot;timesfm&quot;]
  timesfm_configs[&quot;configs&quot;]
  timesfm_flax[&quot;flax&quot;]
  timesfm_flax_dense[&quot;dense&quot;]
  timesfm_flax_normalization[&quot;normalization&quot;]
  timesfm_flax_transformer[&quot;transformer&quot;]
  timesfm_flax_util[&quot;util&quot;]
  timesfm_torch[&quot;torch&quot;]
  timesfm_torch_dense[&quot;dense&quot;]
  timesfm_torch_normalization[&quot;normalization&quot;]
  timesfm_torch_transformer[&quot;transformer&quot;]
  timesfm_torch_util[&quot;util&quot;]
  timesfm_TimesFM_2p5_200M_torch[&quot;TimesFM_2p5_200M_torch&quot;]
  timesfm_TimesFM_2p5_200M_torch_compile(&quot;compile&quot;)
  timesfm_torch_transformer_MultiHeadAttention[&quot;MultiHeadAttention&quot;]
  timesfm_torch_transformer_MultiHeadAttention_forward(&quot;forward&quot;)
  timesfm_torch_transformer_Transformer[&quot;Transformer&quot;]
  timesfm_torch_util_update_running_stats(&quot;update_running_stats&quot;)
  timesfm_torch_transformer_RotaryPositionalEmbedding[&quot;RotaryPositionalEmbedding&quot;]
  timesfm_torch_transformer_RotaryPositionalEmbedding_forward(&quot;forward&quot;)
  timesfm_configs_ForecastConfig[&quot;ForecastConfig&quot;]
  timesfm_ForecastConfig[&quot;ForecastConfig&quot;]
  timesfm_torch_dense_RandomFourierFeatures[&quot;RandomFourierFeatures&quot;]
  timesfm_torch_dense_ResidualBlock[&quot;ResidualBlock&quot;]
  timesfm_torch_transformer_make_attn_mask(&quot;make_attn_mask&quot;)
  timesfm_torch_util_revin(&quot;revin&quot;)
  timesfm_torch_transformer_Transformer_forward(&quot;forward&quot;)
  timesfm_flax_util_scan_along_axis(&quot;scan_along_axis&quot;)
  timesfm_torch_transformer_RMSNorm[&quot;RMSNorm&quot;]
  timesfm_torch_normalization_RMSNorm[&quot;RMSNorm&quot;]
  timesfm_torch_dense_RandomFourierFeatures_forward(&quot;forward&quot;)
  timesfm_configs_TransformerConfig[&quot;TransformerConfig&quot;]
  timesfm_torch_transformer_PerDimScale[&quot;PerDimScale&quot;]
  timesfm_torch_normalization_RMSNorm_forward(&quot;forward&quot;)
  timesfm_torch_transformer_PerDimScale_forward(&quot;forward&quot;)
  timesfm_torch_transformer_RMSNorm_forward(&quot;forward&quot;)
  timesfm_torch_dense_ResidualBlock_forward(&quot;forward&quot;)
  timesfm_flax_util_DecodeCache[&quot;DecodeCache&quot;]
  timesfm_configs_ResidualBlockConfig[&quot;ResidualBlockConfig&quot;]
  timesfm_configs_RandomFourierFeaturesConfig[&quot;RandomFourierFeaturesConfig&quot;]
  timesfm_torch_util_DecodeCache[&quot;DecodeCache&quot;]
  timesfm_torch_transformer_DecodeCache[&quot;DecodeCache&quot;]
  timesfm_configs_StackedTransformersConfig[&quot;StackedTransformersConfig&quot;]
  timesfm_flax_transformer_Transformer[&quot;Transformer&quot;]
  timesfm_flax_dense_ResidualBlock[&quot;ResidualBlock&quot;]
  timesfm_flax_dense_RandomFourierFeatures[&quot;RandomFourierFeatures&quot;]
  timesfm_flax_normalization_RMSNorm[&quot;RMSNorm&quot;]
  timesfm_flax_normalization_LayerNorm[&quot;LayerNorm&quot;]
  timesfm_flax_transformer_make_attn_mask(&quot;make_attn_mask&quot;)
  timesfm_flax_transformer_RotaryPositionalEmbedding[&quot;RotaryPositionalEmbedding&quot;]
  timesfm_flax_transformer_PerDimScale[&quot;PerDimScale&quot;]
  timesfm_flax_transformer_MultiHeadAttention[&quot;MultiHeadAttention&quot;]
  timesfm --&gt; timesfm_configs
  timesfm --&gt; timesfm_flax
  timesfm_flax --&gt; timesfm_flax_dense
  timesfm_flax --&gt; timesfm_flax_normalization
  timesfm_flax --&gt; timesfm_flax_transformer
  timesfm_flax --&gt; timesfm_flax_util
  timesfm --&gt; timesfm_torch
  timesfm_torch --&gt; timesfm_torch_dense
  timesfm_torch --&gt; timesfm_torch_normalization
  timesfm_torch --&gt; timesfm_torch_transformer
  timesfm_torch --&gt; timesfm_torch_util
  timesfm --&gt; timesfm_ForecastConfig
  timesfm --&gt; timesfm_TimesFM_2p5_200M_torch
  timesfm_TimesFM_2p5_200M_torch --&gt; timesfm_TimesFM_2p5_200M_torch_compile
  timesfm_configs --&gt; timesfm_configs_ForecastConfig
  timesfm_configs --&gt; timesfm_configs_RandomFourierFeaturesConfig
  timesfm_configs --&gt; timesfm_configs_ResidualBlockConfig
  timesfm_configs --&gt; timesfm_configs_StackedTransformersConfig
  timesfm_configs --&gt; timesfm_configs_TransformerConfig
  timesfm_flax_dense --&gt; timesfm_flax_dense_ResidualBlock
  timesfm_flax_dense --&gt; timesfm_flax_dense_RandomFourierFeatures
  timesfm_flax_normalization --&gt; timesfm_flax_normalization_RMSNorm
  timesfm_flax_normalization --&gt; timesfm_flax_normalization_LayerNorm
  timesfm_flax_transformer --&gt; timesfm_flax_transformer_make_attn_mask
  timesfm_flax_transformer --&gt; timesfm_flax_transformer_RotaryPositionalEmbedding
  timesfm_flax_transformer --&gt; timesfm_flax_transformer_PerDimScale
  timesfm_flax_transformer --&gt; timesfm_flax_transformer_MultiHeadAttention
  timesfm_flax_transformer --&gt; timesfm_flax_transformer_Transformer
  timesfm_flax_util --&gt; timesfm_flax_util_DecodeCache
  timesfm_flax_util --&gt; timesfm_flax_util_scan_along_axis
  timesfm_torch_dense --&gt; timesfm_torch_dense_RandomFourierFeatures
  timesfm_torch_dense_RandomFourierFeatures --&gt; timesfm_torch_dense_RandomFourierFeatures_forward
  timesfm_torch_dense --&gt; timesfm_torch_dense_ResidualBlock
  timesfm_torch_dense_ResidualBlock --&gt; timesfm_torch_dense_ResidualBlock_forward
  timesfm_torch_normalization --&gt; timesfm_torch_normalization_RMSNorm
  timesfm_torch_normalization_RMSNorm --&gt; timesfm_torch_normalization_RMSNorm_forward
  timesfm_torch_transformer --&gt; timesfm_torch_transformer_DecodeCache
  timesfm_torch_transformer --&gt; timesfm_torch_transformer_MultiHeadAttention
  timesfm_torch_transformer_MultiHeadAttention --&gt; timesfm_torch_transformer_MultiHeadAttention_forward
  timesfm_torch_transformer --&gt; timesfm_torch_transformer_PerDimScale
  timesfm_torch_transformer_PerDimScale --&gt; timesfm_torch_transformer_PerDimScale_forward
  timesfm_torch_transformer --&gt; timesfm_torch_transformer_RMSNorm
  timesfm_torch_transformer_RMSNorm --&gt; timesfm_torch_transformer_RMSNorm_forward
  timesfm_torch_transformer --&gt; timesfm_torch_transformer_RotaryPositionalEmbedding
  timesfm_torch_transformer_RotaryPositionalEmbedding --&gt; timesfm_torch_transformer_RotaryPositionalEmbedding_forward
  timesfm_torch_transformer --&gt; timesfm_torch_transformer_Transformer
  timesfm_torch_transformer_Transformer --&gt; timesfm_torch_transformer_Transformer_forward
  timesfm_torch_transformer --&gt; timesfm_torch_transformer_make_attn_mask
  timesfm_torch_util --&gt; timesfm_torch_util_DecodeCache
  timesfm_torch_util --&gt; timesfm_torch_util_revin
  timesfm_torch_util --&gt; timesfm_torch_util_update_running_stats
  timesfm_torch_dense_RandomFourierFeatures_forward == shared_param ==&gt; timesfm_torch_transformer_PerDimScale_forward
  timesfm_torch_dense_RandomFourierFeatures_forward == shared_param ==&gt; timesfm_torch_dense_ResidualBlock_forward
  timesfm_torch_dense_ResidualBlock_forward == shared_param ==&gt; timesfm_torch_transformer_PerDimScale_forward
  timesfm_torch_dense_ResidualBlock_forward == shared_param ==&gt; timesfm_torch_dense_RandomFourierFeatures_forward
  timesfm_torch_normalization_RMSNorm_forward == shared_param ==&gt; timesfm_torch_transformer_RotaryPositionalEmbedding_forward
  timesfm_torch_normalization_RMSNorm_forward == shared_param ==&gt; timesfm_torch_transformer_RMSNorm_forward
  timesfm_torch_transformer_MultiHeadAttention_forward == shared_param ==&gt; timesfm_torch_transformer_Transformer_forward
  timesfm_torch_transformer_PerDimScale_forward == shared_param ==&gt; timesfm_torch_dense_RandomFourierFeatures_forward
  timesfm_torch_transformer_PerDimScale_forward == shared_param ==&gt; timesfm_torch_dense_ResidualBlock_forward
  timesfm_torch_transformer_RMSNorm_forward == shared_param ==&gt; timesfm_torch_transformer_RotaryPositionalEmbedding_forward
  timesfm_torch_transformer_RMSNorm_forward == shared_param ==&gt; timesfm_torch_normalization_RMSNorm_forward
  timesfm_torch_transformer_RotaryPositionalEmbedding_forward == shared_param ==&gt; timesfm_torch_normalization_RMSNorm_forward
  timesfm_torch_transformer_RotaryPositionalEmbedding_forward == shared_param ==&gt; timesfm_torch_transformer_RMSNorm_forward
  timesfm_torch_transformer_Transformer_forward == shared_param ==&gt; timesfm_torch_transformer_MultiHeadAttention_forward
  timesfm_torch_util_revin == shared_param ==&gt; timesfm_torch_util_update_running_stats
  timesfm_torch_util_update_running_stats == shared_param ==&gt; timesfm_torch_util_revin
  timesfm_flax_transformer_make_attn_mask == shared_event ==&gt; timesfm_torch_transformer_make_attn_mask
  timesfm_flax_util_scan_along_axis == shared_event ==&gt; timesfm_torch_dense_RandomFourierFeatures_forward
  timesfm_torch_dense_RandomFourierFeatures_forward == shared_event ==&gt; timesfm_torch_dense_ResidualBlock_forward
  timesfm_torch_dense_ResidualBlock_forward == shared_event ==&gt; timesfm_torch_normalization_RMSNorm_forward
  timesfm_torch_normalization_RMSNorm_forward == shared_event ==&gt; timesfm_torch_transformer_MultiHeadAttention_forward
  timesfm_torch_transformer_MultiHeadAttention_forward == shared_event ==&gt; timesfm_torch_transformer_PerDimScale_forward
  timesfm_torch_transformer_PerDimScale_forward == shared_event ==&gt; timesfm_torch_transformer_RMSNorm_forward
  timesfm_torch_transformer_RMSNorm_forward == shared_event ==&gt; timesfm_torch_transformer_RotaryPositionalEmbedding_forward
  timesfm_torch_transformer_RotaryPositionalEmbedding_forward == shared_event ==&gt; timesfm_torch_transformer_Transformer_forward
  timesfm_torch_transformer_Transformer_forward == shared_event ==&gt; timesfm_torch_util_revin
  timesfm_torch_util_revin == shared_event ==&gt; timesfm_torch_util_update_running_stats

  </div>
  <script>mermaid.initialize({startOnLoad:true});</script>
</body>
</html>
